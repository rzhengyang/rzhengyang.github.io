<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <!--[if lte IE 9]><meta http-equiv="refresh" content="0;url=/ie.html"><![endif]-->

    <title>Rzy_test2</title>
    <meta name="description" content="">

    <link rel="stylesheet" type="text/css" href="/assets/css/style.css">
  </head>
  <body>
    <aside id="sidebar">
      <nav id="tags">
        <a href="/index.html" id="avatar"></a>

        <ul id="tags__ul">
          <li id="js-label1" class="tags__li tags-btn active">全部</li>
          <li id="js-label2" class="tags__li tags-btn">技术</li>
          <li id="js-label3" class="tags__li tags-btn">旅行</li>
          <li id="js-label4" class="tags__li tags-btn">读书</li>
          <li id="js-label5" class="tags__li tags-btn">精分</li>
          <li id="js-label6" class="tags__li tags-btn">关于我</li>
        </ul>

        <div id="tags__bottom">
          <a href="mailto:place_your_email_address_here" id="icon-email" class="tags-btn fontello"></a>
          <a href="/rss.xml" id="icon-feed" class="tags-btn fontello"></a>
        </div>
      </nav> <!-- end #tags -->

      <div id="posts-list">
        <form action="" id="search-form">
          <a href="/index.html" id="mobile-avatar"></a>
          <!-- NOTE: input field is disabled by default -->
          <!--input id="search-input" type="text" placeholder="Search..." disabled -->
        </form>

        <nav id="pl__container">
        
          <a class="技术 pl__all" href="/%E6%8A%80%E6%9C%AF/2016/09/13/markdown_test3.html"><span class="pl__circle"></span><span class="pl__title">Markdown_test3</span><span class="pl__date">Sep 2016</span></a>
        
          <a class=" pl__all" href="/2016/09/10/rzy_test2.html"><span class="pl__circle"></span><span class="pl__title">Rzy_test2</span><span class="pl__date">Sep 2016</span></a>
        
          <a class=" pl__all" href="/2016/09/08/hello-newBlog_test1.html"><span class="pl__circle"></span><span class="pl__title">Hello Newblog_test1</span><span class="pl__date">Sep 2016</span></a>
        
        </nav>
      </div> <!-- end #posts-list -->
    </aside> <!-- end #sidebar -->

    <div id="post">
      <div id="pjax">
        <article id="post__content">
  <h1 id="post__title" data-identifier="20160910">Rzy_test2</h1>
  <h2 id="videoview">视频播放，选用videoview进行播放器的设计</h2>
<h3 id="layoutvideoview">在layout中，加入videoview控件。</h3>
<pre><code>	X=1;
	who ==2?

</code></pre>

<pre><code>
&lt;VideoView

    android:id="@+id/vido_view"

    android:layout_width="match_parent"

    android:layout_height="241dp" /&gt;


</code></pre>
<h3 id="mainactivityvideoview">在Mainactivity中使用videoview</h3>
<p>oncreat方法中</p>

<pre><code>
videoView = (VideoView)findViewById(R.id.video_view);

initVideoPath();


</code></pre>
<p>initVideoPath()</p>

<pre><code class="language-java```">
File file = new File(Environment.getExternalStorageDirectory(),"1.mp4");//设置播放路径

videoView.setVideoPath(file.getPath());//指定视频文件的路径

if(file.exists()){

    Log.v("Billy","exists");   

}

</code></pre>
<p>onClick方法</p>

<pre><code class="language-java```">
public void onClick(View v) {

switch (v.getId()) {

case R.id.play:

    if (!mediaPlayer.isPlaying()) {

    mediaPlayer.start(); // 开始播放

    }

break;

case R.id.pause:

    if (mediaPlayer.isPlaying()) {

    mediaPlayer.pause(); // 暂停播放

    }

break;

case R.id.stop:

    if (mediaPlayer.isPlaying()) {

    mediaPlayer.reset(); // 停止播放

    initMediaPlayer();

    }

break;

default:

break;

}

}

</code></pre>

<p>在onDestory中进行释放</p>

<pre><code class="language-java```">
protected void onDestroy() {

    super.onDestroy();

    if (mediaPlayer != null) {

        mediaPlayer.stop();

        mediaPlayer.release();

    }

}

</code></pre>
<h4 id="videoviewsd">安卓使用videoview播放视频,做视频播放器需要SD卡读写权限.要不然可以找到视频文件,播放器显示无法播放视频.</h4>

<pre><code class="language-xml```">
&lt;uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/&gt;

&lt;uses-permission android:name="android.permission.MOUNT_UNMOUNT_FILESYSTEMS"/&gt;

</code></pre>
<h4 id="app">让整个APP没有标题栏</h4>

<pre><code class="language-xml```">
android:theme = "@android:style/Theme.Black.NoTitleBar.Fullscreen"

</code></pre>
<h4 id="androidmanifestxmlactivity">强制横屏在AndroidManifest.xml的activity中</h4>

<pre><code class="language-xml```">
android:launchMode = "singleTask"

android:screenorientation = "landscape"

</code></pre>
<h4 id="section">让视频播放全屏</h4>
<pre><code class="language-java```"> case R.id.fullscreen://全屏/窗口切换
      {
       if(!fullscreenFlag){//设置RelativeLayout的全屏模式
        RelativeLayout.LayoutParams layoutParams=new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.FILL_PARENT, RelativeLayout.LayoutParams.FILL_PARENT);
            layoutParams.addRule(RelativeLayout.ALIGN_PARENT_BOTTOM);
            layoutParams.addRule(RelativeLayout.ALIGN_PARENT_TOP);
            layoutParams.addRule(RelativeLayout.ALIGN_PARENT_LEFT);
            layoutParams.addRule(RelativeLayout.ALIGN_PARENT_RIGHT);
            videoView.setLayoutParams(layoutParams);
        }

else{
           RelativeLayout.LayoutParams lp=new  RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.MATCH_PARENT,RelativeLayout.LayoutParams.MATCH_PARENT);
           lp.addRule(RelativeLayout.ALIGN_PARENT_TOP);
             videoView.setLayoutParams(lp);

        }    

fullscreenFlag = (!fullscreenFlag);break;

      }

</code></pre>
<h4 id="section-1">进度条设计</h4>

<p>在seekbar使用的过程中，出现了一个诡异的现象。duration是视频总长度，seekbar总长度是100。progress是进度条（0-100）的数值。定义了一个</p>

<p>double time = （progress/100）* duration;计算数值总是0</p>

<p>double time = （progress * duration）/100;得到的就是正确的数据。</p>

<p>我最后使用了videoView.seekTo((int)time0);</p>

<p>由此可见，应该是java编译器优化导致的，知道最后使用了一个int类型，优化成为每一步都使用int类型，这样progress/100就变成了0，0 * 其他数都为0。</p>

<h4 id="section-2">至此，播放部分完成。</h4>

<p>可以点击播放、停止、复位、进度条可以拖动控制播放进度（后期补全打开文件功能），软件截图如下：</p>


</article> <!-- end #post__content -->

<div id="post__share">
  <a id="icon-twitter" class="fontello" href="https://twitter.com/intent/tweet?url=place_your_url_here/2016/09/10/rzy_test2.html&text=Rzy_test2" target="_blank"></a>
  <a id="icon-cc" class="fontello" href="http://creativecommons.org/licenses/by-nc-sa/3.0" target="_blank"></a>
  <a id="icon-weibo" class="fontello" href="http://v.t.sina.com.cn/share/share.php?url=place_your_url_here/2016/09/10/rzy_test2.html&title=Rzy_test2" target="_blank"></a>
</div> <!-- end #post__share -->

<div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink" target="_blank">Loading Disqus comments...</a>
</div> <!-- end #disqus_thread -->


      </div> <!-- end #pjax -->

      <div id="post__toc-trigger">
        <div id="post__toc">
          <span id="post__toc-title">Table of Contents</span>
          <ul id="post__toc-ul"></ul>
        </div>
      </div>
    </div> <!-- end #post -->

    <button id="js-fullscreen"><span id="icon-arrow" class="fontello"></span></button>

    <script src="/assets/js/jquery-2.0.3.min.js"></script>
    <script src="/assets/js/jquery.pjax.js"></script>
    <script src="/assets/js/nprogress.js"></script>
    <script src="/assets/js/script.js"></script>
  </body>
</html>
