<h2 id="videoview">视频播放，选用videoview进行播放器的设计</h2>
<h3 id="layoutvideoview">在layout中，加入videoview控件。</h3>
<pre><code>	X=1;
	who ==2?

</code></pre>

<pre><code>
&lt;VideoView

    android:id="@+id/vido_view"

    android:layout_width="match_parent"

    android:layout_height="241dp" /&gt;


</code></pre>
<h3 id="mainactivityvideoview">在Mainactivity中使用videoview</h3>
<p>oncreat方法中</p>

<pre><code>
videoView = (VideoView)findViewById(R.id.video_view);

initVideoPath();


</code></pre>
<p>initVideoPath()</p>

<pre><code class="language-java```">
File file = new File(Environment.getExternalStorageDirectory(),"1.mp4");//设置播放路径

videoView.setVideoPath(file.getPath());//指定视频文件的路径

if(file.exists()){

    Log.v("Billy","exists");   

}

</code></pre>
<p>onClick方法</p>

<pre><code class="language-java```">
public void onClick(View v) {

switch (v.getId()) {

case R.id.play:

    if (!mediaPlayer.isPlaying()) {

    mediaPlayer.start(); // 开始播放

    }

break;

case R.id.pause:

    if (mediaPlayer.isPlaying()) {

    mediaPlayer.pause(); // 暂停播放

    }

break;

case R.id.stop:

    if (mediaPlayer.isPlaying()) {

    mediaPlayer.reset(); // 停止播放

    initMediaPlayer();

    }

break;

default:

break;

}

}

</code></pre>

<p>在onDestory中进行释放</p>

<pre><code class="language-java```">
protected void onDestroy() {

    super.onDestroy();

    if (mediaPlayer != null) {

        mediaPlayer.stop();

        mediaPlayer.release();

    }

}

</code></pre>
<h4 id="videoviewsd">安卓使用videoview播放视频,做视频播放器需要SD卡读写权限.要不然可以找到视频文件,播放器显示无法播放视频.</h4>

<pre><code class="language-xml```">
&lt;uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/&gt;

&lt;uses-permission android:name="android.permission.MOUNT_UNMOUNT_FILESYSTEMS"/&gt;

</code></pre>
<h4 id="app">让整个APP没有标题栏</h4>

<pre><code class="language-xml```">
android:theme = "@android:style/Theme.Black.NoTitleBar.Fullscreen"

</code></pre>
<h4 id="androidmanifestxmlactivity">强制横屏在AndroidManifest.xml的activity中</h4>

<pre><code class="language-xml```">
android:launchMode = "singleTask"

android:screenorientation = "landscape"

</code></pre>
<h4 id="section">让视频播放全屏</h4>
<pre><code class="language-java```"> case R.id.fullscreen://全屏/窗口切换
      {
       if(!fullscreenFlag){//设置RelativeLayout的全屏模式
        RelativeLayout.LayoutParams layoutParams=new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.FILL_PARENT, RelativeLayout.LayoutParams.FILL_PARENT);
            layoutParams.addRule(RelativeLayout.ALIGN_PARENT_BOTTOM);
            layoutParams.addRule(RelativeLayout.ALIGN_PARENT_TOP);
            layoutParams.addRule(RelativeLayout.ALIGN_PARENT_LEFT);
            layoutParams.addRule(RelativeLayout.ALIGN_PARENT_RIGHT);
            videoView.setLayoutParams(layoutParams);
        }

else{
           RelativeLayout.LayoutParams lp=new  RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.MATCH_PARENT,RelativeLayout.LayoutParams.MATCH_PARENT);
           lp.addRule(RelativeLayout.ALIGN_PARENT_TOP);
             videoView.setLayoutParams(lp);

        }    

fullscreenFlag = (!fullscreenFlag);break;

      }

</code></pre>
<h4 id="section-1">进度条设计</h4>

<p>在seekbar使用的过程中，出现了一个诡异的现象。duration是视频总长度，seekbar总长度是100。progress是进度条（0-100）的数值。定义了一个</p>

<p>double time = （progress/100）* duration;计算数值总是0</p>

<p>double time = （progress * duration）/100;得到的就是正确的数据。</p>

<p>我最后使用了videoView.seekTo((int)time0);</p>

<p>由此可见，应该是java编译器优化导致的，知道最后使用了一个int类型，优化成为每一步都使用int类型，这样progress/100就变成了0，0 * 其他数都为0。</p>

<h4 id="section-2">至此，播放部分完成。</h4>

<p>可以点击播放、停止、复位、进度条可以拖动控制播放进度（后期补全打开文件功能），软件截图如下：</p>

